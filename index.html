<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (V.6 ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå)</title>
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; padding: 15px; max-width: 650px; margin: auto; color: #333; }
        .card { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 10px; border: 1px solid #ddd; }
        h3 { color: #1a73e8; margin: 0 0 10px 0; border-bottom: 1px solid #eee; padding-bottom: 5px; font-size: 1.1em; }
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        input[type="number"], input[type="text"], input[type="date"], select { padding: 8px; border: 1px solid #ccc; border-radius: 6px; width: 45%; font-size: 16px; }
        .res-val { width: 20%; text-align: right; font-weight: bold; color: #555; }
        .total-box { background-color: #e8f0fe; padding: 8px; text-align: right; font-weight: bold; color: #1967d2; border-radius: 6px; margin-top: 5px; }
        .summary-section { background-color: #fffde7; border: 2px solid #fdd835; }
        .calc-detail { font-size: 0.95em; line-height: 1.8; margin-top: 10px; padding: 15px; background: #fff; border-radius: 8px; border: 1px dashed #ccc; }
        .final-box { background-color: #e8f5e9; color: #2e7d32; padding: 10px; border-radius: 6px; text-align: center; font-size: 1.5em; font-weight: bold; margin-top: 10px; border: 2px solid #a5d6a7; }
        .minus { color: #d32f2f; font-weight: bold; }
        .plus { color: #2e7d32; font-weight: bold; }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; padding: 15px; font-size: 16px; border-radius: 8px; cursor: pointer; border: none; font-weight: bold; color: white; }
        .btn-full { background-color: #6c757d; }
        .btn-short { background-color: #28a745; }

        /* ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏ï‡πå */
        @media print {
            .no-print, .btn-group { display: none !important; }
            body { background: white; padding: 0; }
            .card { border: 1px solid #000; box-shadow: none; margin-bottom: 10px; padding: 10px; }
            h3 { color: black; border-bottom: 1px solid #000; }
            /* ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠ (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ú‡πà‡∏≤‡∏ô JavaScript) */
            body.print-short-mode #expenseSection { display: none !important; }
        }
    </style>
</head>
<body>

    <h2 style="text-align: center; margin-bottom: 10px;">üìù ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
    
    <div class="card">
        <div class="row"><label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label><input type="date" id="dateInput"></div>
    </div>

    <div class="card" id="coinSection">
        <h3>üí∞ 1. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç (‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)</h3>
        <div class="row"><label>‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç 10 x</label><input type="number" id="c10" oninput="calc()"><span class="res-val" id="r_c10">0</span></div>
        <div class="row"><label>‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç 5 x</label><input type="number" id="c5" oninput="calc()"><span class="res-val" id="r_c5">0</span></div>
        <div class="row"><label>‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç 2 x</label><input type="number" id="c2" oninput="calc()"><span class="res-val" id="r_c2">0</span></div>
        <div class="row"><label>‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç 1 x</label><input type="number" id="c1" oninput="calc()"><span class="res-val" id="r_c1">0</span></div>
        <div class="row"><label>‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏°‡∏±‡∏î x</label><input type="number" id="cPack" oninput="calc()"><span class="res-val" id="r_cPack">0</span></div>
        <div class="total-box">‡∏£‡∏ß‡∏°‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (A): <span id="totalCoins">0</span> ‡∏ö‡∏≤‡∏ó</div>
    </div>

    <div class="card" id="bankSection">
        <h3>üíµ 2. ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ö‡∏á‡∏Ñ‡πå</h3>
        <div class="row"><label>‡πÅ‡∏ö‡∏á‡∏Ñ‡πå 1000 x</label><input type="number" id="b1000" oninput="calc()"><span class="res-val" id="r_b1000">0</span></div>
        <div class="row"><label>‡πÅ‡∏ö‡∏á‡∏Ñ‡πå 500 x</label><input type="number" id="b500" oninput="calc()"><span class="res-val" id="r_b500">0</span></div>
        <div class="row"><label>‡πÅ‡∏ö‡∏á‡∏Ñ‡πå 100 x</label><input type="number" id="b100" oninput="calc()"><span class="res-val" id="r_b100">0</span></div>
        <div class="row"><label>‡πÅ‡∏ö‡∏á‡∏Ñ‡πå 50 x</label><input type="number" id="b50" oninput="calc()"><span class="res-val" id="r_b50">0</span></div>
        <div class="row"><label>‡πÅ‡∏ö‡∏á‡∏Ñ‡πå 20 x</label><input type="number" id="b20" oninput="calc()"><span class="res-val" id="r_b20">0</span></div>
        <div class="total-box">‡∏£‡∏ß‡∏°‡πÅ‡∏ö‡∏á‡∏Ñ‡πå: <span id="totalBanks">0</span> ‡∏ö‡∏≤‡∏ó</div>
    </div>

    <div class="card" id="expenseSection">
        <h3>üí∏ 3. ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
        <div class="row no-print">
            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</label>
            <select id="expCount" onchange="generateFields()">
                <option value="0">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢</option>
                <script>for(let i=1; i<=15; i++) document.write(`<option value="${i}">${i} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</option>`);</script>
            </select>
        </div>
        <div id="expenseFields"></div>
        <div class="total-box" style="color:#d32f2f;">‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="totalExpenses">0</span></div>
        <hr style="margin: 10px 0; border: 0; border-top: 1px solid #eee;">
        <div class="row"><label>üì≤ ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô:</label><input type="number" id="transfer" oninput="calc()"></div>
    </div>

    <div class="card summary-section">
        <h3>üìä 4. ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h3>
        <div class="row"><label>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î:</label><input type="number" id="cashSales" oninput="calc()"></div>
        <div class="row"><label>‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô:</label><input type="number" id="yesterdayCoins" oninput="calc()"></div>
        
        <div class="calc-detail" id="calcDetail">
            ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö...
        </div>

        <div class="final-box">
            ‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <span id="finalResult">0</span>
        </div>
    </div>

    <div class="btn-group no-print">
        <button class="btn-full" onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (1,2,3,4)</button>
        <button class="btn-short" onclick="printShort()">üìÑ ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡∏¢‡πà‡∏≠ (1,2,4)</button>
    </div>

    <script>
        function generateFields() {
            const count = document.getElementById('expCount').value;
            const container = document.getElementById('expenseFields');
            container.innerHTML = '';
            for (let i = 1; i <= count; i++) {
                container.innerHTML += `<div class="row"><input type="text" class="exp-name" style="width:55%" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà ${i}"><input type="number" class="exp-amt" style="width:40%" oninput="calc()"></div>`;
            }
            calc();
        }

        function printShort() {
            document.body.classList.add('print-short-mode');
            window.print();
            document.body.classList.remove('print-short-mode');
        }

        function calc() {
            let getVal = (id) => parseFloat(document.getElementById(id).value || 0);
            
            // ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
            let v10=getVal('c10')*10, v5=getVal('c5')*5, v2=getVal('c2')*2, v1=getVal('c1')*1, vp=getVal('cPack')*10;
            let totalCoins = v10+v5+v2+v1+vp;
            document.getElementById('r_c10').innerText = v10.toLocaleString();
            document.getElementById('r_c5').innerText = v5.toLocaleString();
            document.getElementById('r_c2').innerText = v2.toLocaleString();
            document.getElementById('r_c1').innerText = v1.toLocaleString();
            document.getElementById('r_cPack').innerText = vp.toLocaleString();
            document.getElementById('totalCoins').innerText = totalCoins.toLocaleString();

            // ‡πÅ‡∏ö‡∏á‡∏Ñ‡πå
            let b1000=getVal('b1000')*1000, b500=getVal('b500')*500, b100=getVal('b100')*100, b50=getVal('b50')*50, b20=getVal('b20')*20;
            let totalBanks = b1000+b500+b100+b50+b20;
            document.getElementById('r_b1000').innerText = b1000.toLocaleString();
            document.getElementById('r_b500').innerText = b500.toLocaleString();
            document.getElementById('r_b100').innerText = b100.toLocaleString();
            document.getElementById('r_b50').innerText = b50.toLocaleString();
            document.getElementById('r_b20').innerText = b20.toLocaleString();
            document.getElementById('totalBanks').innerText = totalBanks.toLocaleString();

            // ‡∏à‡πà‡∏≤‡∏¢
            let totalExp = 0;
            let expLog = '';
            const names = document.querySelectorAll('.exp-name');
            const amts = document.querySelectorAll('.exp-amt');
            amts.forEach((amt, i) => {
                let val = parseFloat(amt.value || 0);
                if(val > 0) {
                    totalExp += val;
                    expLog += `‡∏´‡∏±‡∏Å ${names[i].value || '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢'}: <span class="minus">-${val.toLocaleString()}</span><br>`;
                }
            });
            document.getElementById('totalExpenses').innerText = totalExp.toLocaleString();

            // ‡∏™‡∏£‡∏∏‡∏õ
            let cash = getVal('cashSales');
            let trans = getVal('transfer');
            let yest = getVal('yesterdayCoins');
            let step1 = cash - totalExp - trans;
            let final = step1 + yest - totalCoins;

            let detailHtml = `<b>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏£‡∏±‡∏ö: ${cash.toLocaleString()}</b><br>`;
            detailHtml += expLog;
            if(trans > 0) detailHtml += `‡∏´‡∏±‡∏Å ‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏≠‡∏ô: <span class="minus">-${trans.toLocaleString()}</span><br>`;
            detailHtml += `<hr>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î: <b>${step1.toLocaleString()}</b><br>`;
            detailHtml += `‡∏ö‡∏ß‡∏Å ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô: <span class="plus">+${yest.toLocaleString()}</span><br>`;
            detailHtml += `‡∏´‡∏±‡∏Å ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (A): <span class="minus">-${totalCoins.toLocaleString()}</span>`;
            
            document.getElementById('calcDetail').innerHTML = detailHtml;
            document.getElementById('finalResult').innerText = final.toLocaleString();
        }
        document.getElementById('dateInput').valueAsDate = new Date();
    </script>
</body>
</html>
